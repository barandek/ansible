# =============================================================================
# OpenVPN Client Configuration
# =============================================================================
# Purpose: Split-tunnel VPN client for Docker services access
# Server: {{ openvpn_server_address }}:{{ openvpn_port }}
# Protocol: {{ openvpn_proto }}
# =============================================================================
# Generated by Ansible - Portable configuration with embedded certificates
# =============================================================================

# Client Mode Configuration
client                                        # Enable client mode
dev tun                                       # Use TUN device for IP routing
proto {{ openvpn_proto }}                     # Protocol (must match server)
remote {{ openvpn_server_address }} {{ openvpn_port }}  # Server address and port

# Connection Management
resolv-retry infinite                        # Retry DNS resolution indefinitely
nobind                                        # Don't bind to local port
persist-key                                   # Don't re-read key files on restart
persist-tun                                   # Don't close and reopen TUN device

# Security and Authentication
remote-cert-tls server                        # Require server certificate verification
cipher AES-256-GCM                            # Encryption cipher (must match server)
auth SHA256                                   # HMAC authentication (must match server)
verb 3                                        # Log verbosity (0=quiet, 4=verbose)

# =============================================================================
# Embedded Certificates (Portable Configuration)
# =============================================================================
# All certificates and keys are embedded for portability
# No external certificate files required
# =============================================================================

<ca>
{{ ca_cert_content }}                         # Certificate Authority certificate
</ca>

<cert>
{{ client_cert_content }}                    # Client certificate
</cert>

<key>
{{ client_key_content }}                     # Client private key
</key>

<tls-auth>
{{ tls_auth_content }}                       # TLS authentication key
</tls-auth>
key-direction 1                              # TLS auth direction (client side)

# =============================================================================
# Split-Tunnel Configuration Notes
# =============================================================================
# - Only Docker network traffic (172.17.0.0/16, 172.18.0.0/16) routes through VPN
# - All other traffic uses local internet connection
# - DNS queries use local DNS servers (not pushed by server)
# - No default gateway pushed (split-tunnel mode)
# =============================================================================
